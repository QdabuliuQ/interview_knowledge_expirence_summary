# 页面加载

从输入URL到页面完全加载完毕的全过程

1. 先在浏览器输入URL链接
2. 浏览器会分别查看 **浏览器缓存，系统缓存，路由缓存** 是否存在页面地址，有则显示，没有进行下一步
3. **DNS域名解析**：浏览器向DNS服务器发起请求，解析URL中的域名对应的IP地址【DNS服务器是基于UDP，因此会用到UDP协议】
4. **建立TCP连接**：解析出IP地址后，根据IP地址和默认80端口，和服务器建立TCP连接
5. **发起HTTP请求**：浏览器发起HTTP请求，该请求是TCP第三次握手后发送的数据确认包给服务器，服务器和客户端进入`ESTABLISH`状态
6. **服务器接收到请求后返回结果给客户端**：把对应的html文件发送给浏览器
7. **关闭TCP连接**：通过四次挥手释放TCP连接
8. **浏览器渲染：**浏览器接收到服务器返回的html文件，进行渲染
   1. **构建DOM树**，树根是document
   2. **构建CSS规则树（CSS RULE TREE）**
   3. **生成render树**：浏览器将DOM树和CSSOM规则树合并，构建出render树
   4. **布局（Layout)**：计算每一个元素在页面的位置
   5. **绘制（Painting）**：遍历render树，将元素渲染到页面

9. **JS引擎执行JS代码**
   1. **创建window对象**，当页面产生时就会被创建，所有的全局变量和方法都是window的属性和方法；当关闭网页的时候，全局执行环境会被销毁
   2. **加载文件**：JS引擎分析语法和词法是否合法，合法则**进入预编译**
   3. **预编译**：在预编译过程中，浏览器会寻找全局变量，将其作为window的属性加入到window对象中，并且给变量赋值`undefined`；寻找全局函数声明，将其作为window方法加入window对象中。
   4. **解释执行**：执行到变量就赋值，如果变量没有被定义就被赋值，在ES5非严格模式下这个变量就会变为window下的属性，也是全局变量；基本类型入栈，引用类型会在堆空间开辟空间，将引用地址放入栈中。