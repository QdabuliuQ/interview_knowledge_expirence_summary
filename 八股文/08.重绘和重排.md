# 重绘和重排

* 重排/回流`reflow`：当Dom的变化影响到了元素的几何信息，浏览器需要重新计算元素在页面中的位置，重置排列局部，这个过程就是重绘
* 重绘：当一个元素的外观发生变化，但没有改变布局，重新把元素的外观绘制出来的过程，叫做重排

重排和重绘的代价都是高昂的，相比之下重排的性能影响更大，尽量选择重绘；

重绘不一定会引起重排，重排一定会引起重绘

### 如何触发重排和重绘

1. 删除，添加，更新一个DOM节点
2. 将元素设置为`display:none`会引起重排和重绘
3. 将元素设置为`visibility:hidden`只会隐藏DOM节点，不会完全删除，所以只触发重绘，其几何信息没有发生变化
4. 给DOM节点添加动画
5. 添加样式表
6. 调整窗口大小，改变字号，滚动页面

### 如何避免重排和重绘

1. 集中改变样式，不要一条一条的改变；可以一次性进行重排或者重绘
2. 为动画的HTML元素设置`fixed, absolute`，修改CSS则不会引起`reflow`重排
3. 不使用`table`布局，小的改动可能会导致整个`table`重新排序
4. 使用GPU加速，动画通过`transform / opacity`去实现
5. 提升为合成层；需要`repaint`的时候，只会`repaint`本身，可以配合CSS属性`will-change`使用