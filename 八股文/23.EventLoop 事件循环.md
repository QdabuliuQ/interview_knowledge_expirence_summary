# EventLoop 事件循环

由于JavaScript是单线程的，为了防止一个函数执行时间过长，阻塞后面的代码，所以会将同步的代码放入执行栈中，依次执行；异步代码会放入异步队列，而异步队列又分为宏任务队列和微任务队列，因为宏任务队列执行时间比较长，所以微任务队列要优先于宏任务队列

* **宏任务**：异步ajax请求，`setTimeout`，`setInterval`，文件操作
* **微任务**：`Promise.then .catch .finally`，和`process.nextTick`

事件循环可以分为以下四个步骤

* 函数入栈，当Stack中发现是异步任务的时候，就将其放入`WebApi`，然后继续执行剩下的同步任务
* 在这个期间，`WebApis`将回调函数放入队列等待执行
* 如果执行栈为空了，`Event Loop`把微任务队列执行清空
* 微任务队列清空后，则进入宏任务队列，每次都会取出一个宏任务放入Stack中执行，执行完成后判断微任务队列中是否存在任务，有的话清除微任务队列；重复第四步，直至宏任务全部执行完毕