# 强制缓存&协商缓存

浏览器和服务器之间的通信为应答方式：浏览器发起HTTP请求 - 服务器响应该请求；所以浏览器在发起HTTP请求之前，会先在缓存中判断是否存在，不存在则再先服务器发起请求，请求成功后的数据会放入缓存当中等待下次相同的请求而使用

![图片](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/487144abaada4b9a8b34bc9375191ec7~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp)

1. 浏览器发起HTTP请求
2. 查看浏览器缓存中是否存在，有则使用缓存的数据，没有进行下一步
3. 向服务器发起HTTP请求
4. 服务器响应请求返回对应的数据
5. 浏览器将数据存入缓存当中，并且缓存标识和缓存规则

浏览器缓存分为两种：**强制缓存和协商缓存**

**强制缓存**就是向浏览器缓存查找该请求结果，并根据该结果的缓存规则来决定是否使用该缓存结果；控制强制缓存的字段有：`Expires`和`Cache-Control`；`Cache-Control`优先级更高

1. 不存在缓存结果和缓存标识，强制缓存失效，则直接向服务器发起请求
2. 存在缓存结果和标识，但是缓存超时失效，使用**协商缓存**
3. 存在缓存结果和标识，且结果不失效，强制缓存生效

**协商缓存**就是强制缓存失效后，浏览器**携带缓存标识**向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程；控制协商缓存的字段有：`Last-Modified / If-Modified-Since`和`Etag / If-None-Match`，其中`Etag / If-None-Match`优先级最高

1. 协商缓存生效，返回304
2. 协商缓存失效，返回200和请求结果结果